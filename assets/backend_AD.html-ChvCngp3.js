import{_ as s,c as n,o as e,a}from"./app-DCyHMlrx.js";const i={},l=a(`<h1 id="backend-ad" tabindex="-1"><a class="header-anchor" href="#backend-ad"><span>Backend AD</span></a></h1><p>Ce backup sert à synchroniser les identitées avec Active Directory sur windows server &gt;= 2019</p><h2 id="modifications-necessaires-sur-windows-serveur-windows-2019" tabindex="-1"><a class="header-anchor" href="#modifications-necessaires-sur-windows-serveur-windows-2019"><span>Modifications necessaires sur windows serveur (&gt;=Windows 2019)</span></a></h2><h3 id="activer-ssh" tabindex="-1"><a class="header-anchor" href="#activer-ssh"><span>Activer ssh :</span></a></h3><ul><li>verification de la fonctionnalité</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">PS &gt;Get-WindowsCapability -Online -Name Open* </span>
<span class="line"></span>
<span class="line"></span>
<span class="line">Name         : OpenSSH.Client~~~~0.0.1.0</span>
<span class="line">State        : Installed</span>
<span class="line">DisplayName  : Client OpenSSH</span>
<span class="line">Description  : Client SSH (Secure Shell) basé sur OpenSSH, pour la gestion de clés sécurisée et l’accès aux</span>
<span class="line">               ordinateurs distants.</span>
<span class="line">DownloadSize : 1323493</span>
<span class="line">InstallSize  : 5301402</span>
<span class="line"></span>
<span class="line">Name         : OpenSSH.Server~~~~0.0.1.0</span>
<span class="line">State        : NotPresent</span>
<span class="line">DisplayName  : Serveur OpenSSH</span>
<span class="line">Description  : Serveur SSH (Secure Shell) basé sur OpenSSH, pour la gestion de clés sécurisée et l’accès à partir</span>
<span class="line">               d&#39;ordinateurs distants.</span>
<span class="line">DownloadSize : 1297677</span>
<span class="line">InstallSize  : 4946932</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Activation :</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">PS&gt; Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">Path          :</span>
<span class="line">Online        : True</span>
<span class="line">RestartNeeded : False</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>verification :</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">PS&gt; Get-Service sshd</span>
<span class="line"></span>
<span class="line">Status   Name               DisplayName</span>
<span class="line">------   ----               -----------</span>
<span class="line">Stopped  sshd               OpenSSH SSH Server</span>
<span class="line"></span>
<span class="line">PS&gt;  Get-Service ssh-agent</span>
<span class="line"></span>
<span class="line">Status   Name               DisplayName</span>
<span class="line">------   ----               -----------</span>
<span class="line">Stopped  ssh-agent          OpenSSH Authentication Agent</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>demarrage des services</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">PS &gt; Start-Service sshd</span>
<span class="line">PS&gt;  Start-Service ssh-agent</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>vérification des services</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">Get-Service sshd</span>
<span class="line"></span>
<span class="line">Status   Name               DisplayName</span>
<span class="line">------   ----               -----------</span>
<span class="line">Running  sshd               OpenSSH SSH Server</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">PS C:\\Users\\Administrateur&gt; Get-Service ssh-agent</span>
<span class="line"></span>
<span class="line">Status   Name               DisplayName</span>
<span class="line">------   ----               -----------</span>
<span class="line">Running  ssh-agent          OpenSSH Authentication Agent</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>activation au démarrage</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">PS &gt;Set-Service -Name ssh-agent -StartupType Automatic</span>
<span class="line">PS &gt;Set-Service -Name sshd -StartupType Automatic</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="changement-de-l-encodage-par-defaut-en-utf-8" tabindex="-1"><a class="header-anchor" href="#changement-de-l-encodage-par-defaut-en-utf-8"><span>Changement de l&#39;encodage par defaut en UTF-8</span></a></h3><p>Si vous voulez les accents dans les noms des utilisateurs vous devez changer l&#39;encodage par défaut</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">Panneau de configuration </span>
<span class="line">   &gt; Horloge et région</span>
<span class="line">      &gt; Région</span>
<span class="line">         &gt; Administration</span>
<span class="line">            &gt; Modifier les paramètres régionaux </span>
<span class="line">               Cochez :  Beta: Utilisez le format Unicode UTF-8 pour une prise en charge ....</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Poue plus d&#39;information consultez la base de connaissance Microsoft : [https://learn.microsoft.com/en-us/windows-server/administration/openssh/openssh_keymanagement]</p><h2 id="installation" tabindex="-1"><a class="header-anchor" href="#installation"><span>Installation</span></a></h2><p>Pour l&#39;instant juste le paquet debian est disponible</p><p>téléchargez le packet debian à l&#39;adresse : <a href="https://github.com/Libertech-FR/sesame-backend-ad/releases/" target="_blank" rel="noopener noreferrer">https://github.com/Libertech-FR/sesame-backend-ad/releases/</a></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">dpkg -i sesame-backend-ad_x.x.x_amd64.deb</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Les erreurs sont normales car il y a des dependences supplémentaires à installer :</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">apt-get install -f</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="activation-et-parametrage" tabindex="-1"><a class="header-anchor" href="#activation-et-parametrage"><span>Activation et paramètrage</span></a></h2><p>allez dans le répertoire /var/lib/sesame-daemon/backend-modules/ad</p><p>et lancez le script d&#39;activation (install.sh</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">cd  /var/lib/sesame-daemon/backend-modules/ad</span>
<span class="line">./install.sh</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Le script va vous demander un certains nombre de renseignement pour pouvoir configurer le backend</p><ul><li><strong>Numero de demarrage du module (2 positions) :</strong> Position d&#39;execution du Backend dans le repertoire /var/lib/sesame-backend/backends. Mettre un chiffre sur 2 positions.</li><li><strong>Adresse du serveur AD primaire :</strong> Entrez le FDQN ou l&#39;adresse IP du serveur de domaine (assurez vous avant que le serveur où est installé le daemon peut accéder au poer 22 (ssh)</li><li><strong>Utilisateur (doit avoir les droits d&#39;administration) :</strong> Utilateur ayant les droits d&#39;administration du serveur</li><li><strong>Mot de passe :</strong> Mot de passe de cet utilisateur (le mot de passe ne sera pas enregistré sur le serveur mais est utilisé pour copier la clé publique qui sera générée par le script</li><li><strong>Base ldap AD :</strong> Base LDAP de votre domaine (vous pouvez l&#39;avoir en vous connectant sur le serveur windows (Utilisateurs et ordinateurs Active Directory -&gt; bouton droit sur le domaine et editeur d&#39;attributs, cherchez &quot;DistinguishedName&quot;)</li><li><strong>Domaine pour UserPrincipalName :</strong> Le nom de domaine sou la forme DOMAIN.XX (vous pouvez le voir dans l&#39;onglet compte d&#39;un utilisateur.</li></ul><p>Une fois les renseignements donnés le script va générer une paire de clés ed25519 et va recopier la clé publique sur le serveur AD</p><h2 id="architecture-du-backend-apres-l-installation" tabindex="-1"><a class="header-anchor" href="#architecture-du-backend-apres-l-installation"><span>Architecture du Backend après l&#39;installation</span></a></h2><p>Le script d&#39;installation aura mis dans dans <strong>/var/lib/sesame-daemon/XXad</strong> les repertoires, fichiers necessaires</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">XXad - etc - config.conf</span>
<span class="line">     - bin - changepwd.py</span>
<span class="line">           - ping.py</span>
<span class="line">           - resetpwd.py</span>
<span class="line">           - upsertidentity.py</span>
<span class="line">     - lib - ad_utils.py</span>
<span class="line">           - backends_utils.py</span>
<span class="line">     - ps1_templates - changepassword.template</span>
<span class="line">     					 - ping.template</span>
<span class="line">     					 - resetpassword.template</span>
<span class="line">     					 - upsertidentity.template</span>
<span class="line">     config.yml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="fichier-de-configuration-etc-config-conf" tabindex="-1"><a class="header-anchor" href="#fichier-de-configuration-etc-config-conf"><span>Fichier de configuration (etc/config.conf)</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line"># Paramètres générés par  install.sh</span>
<span class="line">host=ad.mydomain.com</span>
<span class="line">user=administrator</span>
<span class="line">base=dc=mydomain,dc=com</span>
<span class="line">domain=libertest.fr</span>
<span class="line"># Paramètres que vous devez renseigner manuellement</span>
<span class="line">branchForEtd=ou=Etudiants</span>
<span class="line">branchForAdm=ou=Administratifs</span>
<span class="line">branchForEsn=ou=Enseignants</span>
<span class="line">branchAttr=supannTypeEntiteAffectation</span>
<span class="line">backendFor=adm,etd,esn</span>
<span class="line">debug=0</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="parametres-renseignes-par-install-sh" tabindex="-1"><a class="header-anchor" href="#parametres-renseignes-par-install-sh"><span>Paramètres renseignés par install.sh</span></a></h4><ul><li><strong>host</strong> = adresse du serveur AD primaire</li><li><strong>user</strong> = Utilisateur ayant les droits d&#39;administration</li><li><strong>base</strong> = Base LDAP du domaine (DistinguishedName)</li><li><strong>domain</strong> = domaine sous la forme doamin.xx</li></ul><h4 id="parametres-facultatifs" tabindex="-1"><a class="header-anchor" href="#parametres-facultatifs"><span>Paramètres facultatifs</span></a></h4><ul><li><strong>branchForEtd</strong> = branche relative pour la population etd</li><li><strong>branchForAdm</strong> = branche relative pour la population adm</li><li><strong>branchForEsn</strong> = branche relative pour la population esn</li><li><strong>branchAttr</strong> = Attribut qui sert à determiner le type de population</li><li><strong>backendFor</strong> = Le backend fera l&#39;action pour les populations listées</li><li><strong>debug</strong> = 0|1 si 1 le backend generera le script, lo copiera sur le host mais ne l executera pas</li></ul><p>A noter : vous pouvez ajouter une variable <strong>branchFor</strong> + &quot;type de population &quot;</p><p>exemple branchForChercheurs= ...</p><h4 id="composition-du-dn" tabindex="-1"><a class="header-anchor" href="#composition-du-dn"><span>Composition du DN</span></a></h4><p>Vous pouvez composer le DN avec un template dans la variable <strong>dnTemplate</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">dnTemplate=cn={{ e.cn }},{{branch}},{{config.base}}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>vous disposez comme dans les templates des variable</p><ul><li><strong>e</strong> contient les champs de l&#39;identité</li><li><strong>config</strong> contient la configuration</li><li><strong>branch</strong> contient la branche contenue dans la variable branchForXXX</li><li><strong>rdnValue</strong> contient la valeur du rdn</li></ul><p>Le dn généré se retrouvera disponible dans la variable <strong>dn</strong> pour le template</p><h4 id="parametres-personalises" tabindex="-1"><a class="header-anchor" href="#parametres-personalises"><span>Paramètres personalisés</span></a></h4><p><strong>monparametre</strong> = mavaleur</p><p>Ces paramètres seront accessibles dans les templates sous la forme</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">{{ config.monparametre }} </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="les-templates-powershell" tabindex="-1"><a class="header-anchor" href="#les-templates-powershell"><span>Les templates powershell</span></a></h3><p>Le principe de fonctionnenemt est le suivant :</p><ul><li>Le script python genére un script powershell par rapport au modèle (templates).</li><li>Le script copie via ssh le script généré sur le serveur windows.</li><li>Le script powershell est exécuté.</li></ul><p>Les templates sont généré avec la librairie <strong>jinja2</strong></p><p>Vous trouverez la documentation Jinja à <a href="https://jinja.palletsprojects.com/en/3.1.x/templates/" target="_blank" rel="noopener noreferrer">https://jinja.palletsprojects.com/en/3.1.x/templates/</a></p><p>Les variables disponibles pour le template sont :</p><ul><li><strong>e</strong> L&#39;identité sous forme e.attribut exemple : e.cn, e.supannTypeEntiteAffectation</li><li><strong>domain</strong> la variable domain du fichier de configuration</li><li><strong>base</strong> Base LDAP du domaine present dans le fichier de configuration</li><li><strong>dn</strong> Le DN calculé de l&#39;identité</li><li><strong>path</strong> le DN superieur de l&#39;identité</li><li><strong>config</strong> les variables du fichier de configuration (etc/config.conf)</li></ul><p>Exemple de template (upsertidentity.template)</p><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="line"><span class="token keyword">try</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$tab</span>=<span class="token function">Get-ADUser</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token string">&#39;employeeNumber -eq &quot;{{ e.employeeNumber }}&quot; -and employeeType -eq &quot;{{ e.employeeType }}&quot;&#39;</span> <span class="token operator">-</span>Properties <span class="token string">&quot;DistinguishedName&quot;</span></span>
<span class="line">	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$tab</span><span class="token punctuation">[</span><span class="token string">&quot;DistinguishedName&quot;</span><span class="token punctuation">]</span> <span class="token operator">-ne</span> <span class="token string">&quot;{{ dn }}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">	    <span class="token keyword">try</span><span class="token punctuation">{</span></span>
<span class="line">	        <span class="token variable">$dn</span>=<span class="token variable">$tab</span><span class="token punctuation">[</span><span class="token string">&quot;DistinguishedName&quot;</span><span class="token punctuation">]</span></span>
<span class="line">            <span class="token function">move-adObject</span> <span class="token string">&quot;<span class="token variable">$dn</span>&quot;</span> <span class="token operator">-</span>targetpath <span class="token string">&quot;{{ path }}&quot;</span></span>
<span class="line">	    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">{</span></span>
<span class="line">	        <span class="token function">Write-Host</span> <span class="token variable">$_</span></span>
<span class="line">            <span class="token keyword">exit</span> 1</span>
<span class="line">	    <span class="token punctuation">}</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token variable">$UserExists</span> = <span class="token boolean">$true</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">catch</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$UserExists</span> = <span class="token boolean">$false</span></span>
<span class="line"><span class="token punctuation">}</span> </span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$UserExists</span> <span class="token operator">-eq</span> <span class="token boolean">$false</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$np</span> = @<span class="token punctuation">{</span></span>
<span class="line">       Path=<span class="token string">&quot;{{ path }}&quot;</span></span>
<span class="line">       EmployeeNumber=<span class="token string">&quot;{{ e.employeeNumber }}&quot;</span></span>
<span class="line">       Name=<span class="token string">&quot;{{ e.cn }}&quot;</span></span>
<span class="line">       DisplayName=<span class="token string">&quot;{{ e.displayName }}&quot;</span></span>
<span class="line">       GivenName=<span class="token string">&quot;{{ e.givenName }}&quot;</span></span>
<span class="line">       Surname=<span class="token string">&quot;{{ e.sn }}&quot;</span></span>
<span class="line">       SamAccountName=<span class="token string">&quot;{{ e.uid }}&quot;</span></span>
<span class="line">       EmailAddress=<span class="token string">&quot;{{ e.mail }}&quot;</span></span>
<span class="line">       UserPrincipalName = <span class="token string">&quot;{{ e.uid }}&quot;</span> <span class="token operator">+</span> <span class="token string">&#39;@&#39;</span> <span class="token operator">+</span> <span class="token string">&quot;{{ domain }}&quot;</span></span>
<span class="line">       Enabled=<span class="token boolean">$false</span></span>
<span class="line">       CannotChangePassword=<span class="token boolean">$true</span></span>
<span class="line">       ChangePasswordAtLogon = <span class="token boolean">$false</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">new-adUser</span> @np <span class="token operator">-</span>OtherAttributes @<span class="token punctuation">{</span> <span class="token string">&#39;EmployeeType&#39;</span> = <span class="token string">&#39;{{ e.employeeType }}&#39;</span> <span class="token punctuation">}</span></span>
<span class="line">        <span class="token function">Write-Host</span> <span class="token string">&quot;Identity created&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Write-Host</span> <span class="token variable">$_</span></span>
<span class="line">        <span class="token keyword">exit</span> 1</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$dn</span>=<span class="token variable">$tab</span><span class="token punctuation">[</span><span class="token string">&quot;DistinguishedName&quot;</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token variable">$UserPrincipalName</span> = <span class="token string">&quot;{{ e.uid }}&quot;</span> <span class="token operator">+</span> <span class="token string">&#39;@&#39;</span> <span class="token operator">+</span> <span class="token string">&quot;{{ domain }}&quot;</span></span>
<span class="line">        <span class="token function">set-adUser</span> <span class="token operator">-</span>Identity <span class="token string">&quot;<span class="token variable">$dn</span>&quot;</span> <span class="token operator">-</span>SamAccountName <span class="token string">&quot;{{ e.uid }}&quot;</span> <span class="token operator">-</span>DisplayName <span class="token string">&quot;{{e.displayName}}&quot;</span> <span class="token operator">-</span>GivenName <span class="token string">&quot;{{ e.givenName }}&quot;</span> <span class="token operator">-</span>EmailAddress <span class="token string">&quot;{{ e.mail }}&quot;</span> <span class="token operator">-</span>UserPrincipalName <span class="token string">&quot;<span class="token variable">$UserPrincipalName</span>&quot;</span></span>
<span class="line">        <span class="token function">Write-Host</span> <span class="token string">&quot;Identity modified&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Write-Host</span> <span class="token variable">$_</span></span>
<span class="line">        <span class="token keyword">exit</span> 1</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">exit</span> 0</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Le powershell doit donner un code de retour (exit)</p><ul><li>0 tout est ok</li><li>1 Erreur</li></ul><p>L&#39;erreur ou le message doit être écrite sur la sortie standard (Write-Host)</p><h1 id="deboggage" tabindex="-1"><a class="header-anchor" href="#deboggage"><span>deboggage</span></a></h1><p>la variable <strong>debug</strong> du fichier de configuration, si elle est positionnée à 1, permet de générer le script, de le copier sur le serveur, mais il ne sera pas executé</p>`,68),t=[l];function r(p,c){return e(),n("div",null,t)}const o=s(i,[["render",r],["__file","backend_AD.html.vue"]]),u=JSON.parse(`{"path":"/backends/backend_AD.html","title":"Backend AD","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"Modifications necessaires sur windows serveur (>=Windows 2019)","slug":"modifications-necessaires-sur-windows-serveur-windows-2019","link":"#modifications-necessaires-sur-windows-serveur-windows-2019","children":[{"level":3,"title":"Activer ssh :","slug":"activer-ssh","link":"#activer-ssh","children":[]},{"level":3,"title":"Changement de l'encodage par defaut en UTF-8","slug":"changement-de-l-encodage-par-defaut-en-utf-8","link":"#changement-de-l-encodage-par-defaut-en-utf-8","children":[]}]},{"level":2,"title":"Installation","slug":"installation","link":"#installation","children":[]},{"level":2,"title":"Activation et paramètrage","slug":"activation-et-parametrage","link":"#activation-et-parametrage","children":[]},{"level":2,"title":"Architecture du Backend après l'installation","slug":"architecture-du-backend-apres-l-installation","link":"#architecture-du-backend-apres-l-installation","children":[{"level":3,"title":"Fichier de configuration (etc/config.conf)","slug":"fichier-de-configuration-etc-config-conf","link":"#fichier-de-configuration-etc-config-conf","children":[]},{"level":3,"title":"Les templates powershell","slug":"les-templates-powershell","link":"#les-templates-powershell","children":[]}]}],"git":{"updatedTime":1732197892000,"contributors":[{"name":"Alain Abbas","email":"alain.abbas@libertech.fr","commits":9}]},"filePathRelative":"backends/backend_AD.md"}`);export{o as comp,u as data};
