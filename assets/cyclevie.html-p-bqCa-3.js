import{_ as e,c as s,o as n,a}from"./app-_lnrcfi7.js";const t={},i=a(`<h1 id="gestion-du-cycle-de-vie" tabindex="-1"><a class="header-anchor" href="#gestion-du-cycle-de-vie"><span>Gestion du cycle de vie</span></a></h1><p>Sesame comprend une fonctionnalité de gestion du cycle de vie des identités. Elle permet de gérer les transitions de statut automatiquement selon des règles établies.</p><h2 id="activation" tabindex="-1"><a class="header-anchor" href="#activation"><span>Activation</span></a></h2><p>Par défaut le cycle de vie n&#39;est pas actif. Pour l&#39;activer il suffit d&#39;ajouter un point de montage pour le conteneur sesame-orchestrator</p><ul><li>Dans docker-compose section <strong>sesame-orchestrator</strong> -&gt; <strong>volumes</strong> ajouter</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">- ./configs/sesame-orchestrator/lifecycle:/data/configs/lifecycle</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>redémarrer votre container</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">docker compose up -d</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="configuration" tabindex="-1"><a class="header-anchor" href="#configuration"><span>Configuration</span></a></h2><p>La configuration se fait à l&#39;aide de fichiers yml situé dans le volume (./configs/sesame-orchestrator/lifecycle)</p><h3 id="noms-des-fichiers" tabindex="-1"><a class="header-anchor" href="#noms-des-fichiers"><span>Noms des fichiers</span></a></h3><p>Les noms de fichiers dans le répertoire <strong>./configs/sesame-orchestrator/lifecycle</strong>. Les fichiers seront traités par ordre alphabétique.</p><h3 id="structure-d-un-fichier-cycle-de-vie" tabindex="-1"><a class="header-anchor" href="#structure-d-un-fichier-cycle-de-vie"><span>Structure d&#39;un fichier cycle de vie</span></a></h3><h4 id="forme-1-selection-des-identites-par-une-regle" tabindex="-1"><a class="header-anchor" href="#forme-1-selection-des-identites-par-une-regle"><span><strong>Forme 1</strong> : sélection des identités par une régle</span></a></h4><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="line"><span class="token key atrule">identities</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> <span class="token key atrule">sources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;W&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token key atrule">rules</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">     <span class="token key atrule">&#39;inetOrgPerson.employeeType&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;TAIGA&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token key atrule">target</span><span class="token punctuation">:</span> D</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>identities</strong> : le fichier doit avoir toujour cette clé en point d&#39;entrée</li><li><strong>sources</strong> : tableau de declenchement selon le statut sous la forme [ status1, status2, ... ]. Dans l&#39;exemple ci dessus ce lifecyle sera déclencher sur le status I (Inactive) ou W(En Attente)</li></ul><p>Rappel des statuts :</p><table><thead><tr><th>Lettre</th><th>statut</th></tr></thead><tbody><tr><td>O</td><td>Officiel</td></tr><tr><td>I</td><td>Inactive</td></tr><tr><td>M</td><td>Manuel</td></tr></tbody></table><ul><li><strong>rules</strong> : Requète mongo de selection des identités concernées (voir la documentation Mongo. Vous pouvez tester directement la règle avec un editeur Mongo)</li></ul><p>Dans cet exemple seul les identités venant de Taiga seront concernées</p><ul><li><strong>target</strong> : statut resultant Dans cet exemple toutes les identités qui auront le statut Inactive ou En attente seront passé en statut Supprimé</li></ul><h4 id="forme-2-selection-par-trigger" tabindex="-1"><a class="header-anchor" href="#forme-2-selection-par-trigger"><span><strong>Forme 2</strong> : séléction par trigger</span></a></h4><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="line"><span class="token key atrule">identities</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> <span class="token key atrule">sources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token key atrule">rules</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token key atrule">&#39;inetOrgPerson.departmentNumber&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;etd&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token key atrule">trigger</span><span class="token punctuation">:</span> 36d</span>
<span class="line">    <span class="token key atrule">target</span><span class="token punctuation">:</span> D</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>La balise <strong>rules</strong> est remplacée par la balise <strong>trigger</strong> . Elle permet de definir un delai entre 2 statuts</p><ul><li>trigger : nombre negatif representant une periode (jour) d&#39;attente entre les deux statuts Dans l&#39;exemple ci dessus les identitées etant inactive seront supprimées apres un delai de 36 jours de leur passage en inactive</li></ul><h4 id="avec-une-mutation-de-l-enregistrement" tabindex="-1"><a class="header-anchor" href="#avec-une-mutation-de-l-enregistrement"><span><strong>Avec une mutation</strong> de l&#39;enregistrement</span></a></h4><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="line"><span class="token key atrule">identities</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> <span class="token key atrule">sources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;W&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token key atrule">rules</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">     <span class="token key atrule">&#39;inetOrgPerson.employeeType&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;TAIGA&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token key atrule">mutation</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token key atrule">&#39;inetOrgPerson.cn&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;mutated&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token key atrule">target</span><span class="token punctuation">:</span> D</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Il est possible d&#39;ajouter une mutation de l&#39;enregistrement avant le passage au statut cible Dans l&#39;exemple ci dessus le champ inetOrgPerson.cn sera modifié avant le passage au statut D</p>`,28),l=[i];function c(r,p){return n(),s("div",null,l)}const u=e(t,[["render",c],["__file","cyclevie.html.vue"]]),d=JSON.parse(`{"path":"/configuration/cyclevie.html","title":"Cycle de vie","lang":"en-US","frontmatter":{"lang":"en-US","title":"Cycle de vie","description":"Gestion du cycle de vie des identités"},"headers":[{"level":2,"title":"Activation","slug":"activation","link":"#activation","children":[]},{"level":2,"title":"Configuration","slug":"configuration","link":"#configuration","children":[{"level":3,"title":"Noms des fichiers","slug":"noms-des-fichiers","link":"#noms-des-fichiers","children":[]},{"level":3,"title":"Structure d'un fichier cycle de vie","slug":"structure-d-un-fichier-cycle-de-vie","link":"#structure-d-un-fichier-cycle-de-vie","children":[]}]}],"git":{"updatedTime":1760079801000,"contributors":[{"name":"Tacx","email":"12997062+tacxou@users.noreply.github.com","commits":3},{"name":"Alain Abbas","email":"alain.abbas@libertech.fr","commits":2}]},"filePathRelative":"configuration/cyclevie.md"}`);export{u as comp,d as data};
